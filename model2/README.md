# ERAV3_Assignment7: model-2


### Model Summary
```
----------------------------------------------------------------
        Layer (type)               Output Shape         Param #
================================================================
            Conv2d-1           [-1, 10, 26, 26]              90
       BatchNorm2d-2           [-1, 10, 26, 26]              20
           Dropout-3           [-1, 10, 26, 26]               0
              ReLU-4           [-1, 10, 26, 26]               0
            Conv2d-5           [-1, 20, 24, 24]           1,800
       BatchNorm2d-6           [-1, 20, 24, 24]              40
           Dropout-7           [-1, 20, 24, 24]               0
              ReLU-8           [-1, 20, 24, 24]               0
            Conv2d-9           [-1, 12, 22, 22]           2,160
      BatchNorm2d-10           [-1, 12, 22, 22]              24
          Dropout-11           [-1, 12, 22, 22]               0
             ReLU-12           [-1, 12, 22, 22]               0
           Conv2d-13           [-1, 10, 22, 22]             120
        MaxPool2d-14           [-1, 10, 11, 11]               0
           Conv2d-15             [-1, 12, 9, 9]           1,080
      BatchNorm2d-16             [-1, 12, 9, 9]              24
          Dropout-17             [-1, 12, 9, 9]               0
             ReLU-18             [-1, 12, 9, 9]               0
           Conv2d-19             [-1, 12, 7, 7]           1,296
      BatchNorm2d-20             [-1, 12, 7, 7]              24
          Dropout-21             [-1, 12, 7, 7]               0
             ReLU-22             [-1, 12, 7, 7]               0
           Conv2d-23             [-1, 10, 5, 5]           1,080
      BatchNorm2d-24             [-1, 10, 5, 5]              20
          Dropout-25             [-1, 10, 5, 5]               0
             ReLU-26             [-1, 10, 5, 5]               0
AdaptiveAvgPool2d-27             [-1, 10, 1, 1]               0
           Conv2d-28             [-1, 10, 1, 1]             100
================================================================
Total params: 7,878
Trainable params: 7,878
Non-trainable params: 0
----------------------------------------------------------------
Input size (MB): 0.00
Forward/backward pass size (MB): 0.84
Params size (MB): 0.03
Estimated Total Size (MB): 0.87
----------------------------------------------------------------
```

### Model Input Sizes, Output Sizes and Receptive Field Computation
```

# Layer-wise Analysis of the Neural Network
| Layer            | Input Size      | Output Size     | Input Channels | Output Channels | Kernel Size | Stride | Padding | Receptive Field |
|-------------------|-----------------|-----------------|----------------|-----------------|-------------|--------|---------|----------------|
| Input            | 28x28           | 28x28           | 1              | 1               | -           | -      | -       | 1              |
| Conv1 + BN + ReLU| 28x28           | 26x26           | 1              | 10              | 3x3         | 1      | 0       | 3              |
| Conv2 + BN + ReLU| 26x26           | 24x24           | 10             | 20              | 3x3         | 1      | 0       | 5              |
| Conv3 + BN + ReLU| 24x24           | 22x22           | 20             | 12              | 3x3         | 1      | 0       | 7              |
| Transition1      | 22x22           | 11x11           | 12             | 10              | 1x1, 2x2    | 2      | 0       | 8              |
| Conv4 + BN + ReLU| 11x11           | 9x9             | 10             | 12              | 3x3         | 1      | 0       | 12             |
| Conv5 + BN + ReLU| 9x9             | 7x7             | 12             | 12              | 3x3         | 1      | 0       | 16             |
| Conv6 + BN + ReLU| 7x7             | 5x5             | 12             | 10              | 3x3         | 1      | 0       | 20             |
| GAP              | 5x5             | 1x1             | 10             | 10              | 5x5         | -      | -       | 28             |
| Conv7            | 1x1             | 1x1             | 10             | 10              | 1x1         | 1      | 0       | 28             |
```


### Target:
  1. Solve the problem of overfitting by using regularization techniques and under model parameters of 8000.

### Results:
  1. Parameters: 7,878
  2. Best Train Accuracy: 99.00%
  3. Best Test Accuracy: 99.23%

### Analysis:
  1. The model is not over fitting.
  2. Use of Regularization techniques like droput to overcome overfitting and was achieved. Dropout of 0.1 was initially tried but 0.7 yielded better training and test accuracies.
  3. Earlier, maxpool was used in two layers but reducing it to one increased both the training and test accuracies by 1% and could easily reach ~99.2% by doing so.
  4. Perhaps, we should add image augmentation techniques to improve the model and also a better scheduler to achieve the best plateau during training.



### Training Logs
```
--------------------------------------------
EPOCH: 0
Loss=0.10710171610116959 Batch_id=468 Accuracy=79.06: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 469/469 [01:19<00:00,  5.87it/s]

Training set: Average loss: 0.1071, Accuracy: 47437/60000 (79.06%)


Test set: Average loss: 0.1670, Accuracy: 9613/10000 (96.13%)

--------------------------------------------
--------------------------------------------
EPOCH: 1
Loss=0.07970884442329407 Batch_id=468 Accuracy=97.26: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 469/469 [01:23<00:00,  5.61it/s]

Training set: Average loss: 0.0797, Accuracy: 58355/60000 (97.26%)


Test set: Average loss: 0.0669, Accuracy: 9837/10000 (98.37%)

--------------------------------------------
--------------------------------------------
EPOCH: 2
Loss=0.04361895099282265 Batch_id=468 Accuracy=97.93: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 469/469 [01:28<00:00,  5.29it/s]

Training set: Average loss: 0.0436, Accuracy: 58759/60000 (97.93%)


Test set: Average loss: 0.0430, Accuracy: 9886/10000 (98.86%)

--------------------------------------------
--------------------------------------------
EPOCH: 3
Loss=0.08084238320589066 Batch_id=468 Accuracy=98.21: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 469/469 [01:05<00:00,  7.11it/s]

Training set: Average loss: 0.0808, Accuracy: 58925/60000 (98.21%)


Test set: Average loss: 0.0456, Accuracy: 9875/10000 (98.75%)

--------------------------------------------
--------------------------------------------
EPOCH: 4
Loss=0.06596678495407104 Batch_id=468 Accuracy=98.41: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 469/469 [01:08<00:00,  6.84it/s]

Training set: Average loss: 0.0660, Accuracy: 59044/60000 (98.41%)


Test set: Average loss: 0.0393, Accuracy: 9900/10000 (99.00%)

--------------------------------------------
--------------------------------------------
EPOCH: 5
Loss=0.10739175230264664 Batch_id=468 Accuracy=98.57: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 469/469 [01:31<00:00,  5.15it/s]

Training set: Average loss: 0.1074, Accuracy: 59140/60000 (98.57%)


Test set: Average loss: 0.0386, Accuracy: 9884/10000 (98.84%)

--------------------------------------------
--------------------------------------------
EPOCH: 6
Loss=0.06653449684381485 Batch_id=468 Accuracy=98.85: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 469/469 [01:27<00:00,  5.37it/s]

Training set: Average loss: 0.0665, Accuracy: 59310/60000 (98.85%)


Test set: Average loss: 0.0286, Accuracy: 9918/10000 (99.18%)

--------------------------------------------
--------------------------------------------
EPOCH: 7
Loss=0.06075391173362732 Batch_id=468 Accuracy=98.92: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 469/469 [01:20<00:00,  5.85it/s]

Training set: Average loss: 0.0608, Accuracy: 59349/60000 (98.92%)


Test set: Average loss: 0.0291, Accuracy: 9917/10000 (99.17%)

--------------------------------------------
--------------------------------------------
EPOCH: 8
Loss=0.051069226115942 Batch_id=468 Accuracy=98.98: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 469/469 [01:18<00:00,  5.96it/s]

Training set: Average loss: 0.0511, Accuracy: 59388/60000 (98.98%)


Test set: Average loss: 0.0288, Accuracy: 9919/10000 (99.19%)

--------------------------------------------
--------------------------------------------
EPOCH: 9
Loss=0.039839766919612885 Batch_id=468 Accuracy=98.95: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████| 469/469 [01:14<00:00,  6.27it/s]

Training set: Average loss: 0.0398, Accuracy: 59368/60000 (98.95%)


Test set: Average loss: 0.0284, Accuracy: 9917/10000 (99.17%)

--------------------------------------------
--------------------------------------------
EPOCH: 10
Loss=0.03421279042959213 Batch_id=468 Accuracy=98.92: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 469/469 [01:03<00:00,  7.41it/s]

Training set: Average loss: 0.0342, Accuracy: 59350/60000 (98.92%)


Test set: Average loss: 0.0273, Accuracy: 9920/10000 (99.20%)

--------------------------------------------
--------------------------------------------
EPOCH: 11
Loss=0.012253508903086185 Batch_id=468 Accuracy=98.99: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████| 469/469 [01:01<00:00,  7.66it/s]

Training set: Average loss: 0.0123, Accuracy: 59394/60000 (98.99%)


Test set: Average loss: 0.0271, Accuracy: 9925/10000 (99.25%)

--------------------------------------------
--------------------------------------------
EPOCH: 12
Loss=0.040493857115507126 Batch_id=468 Accuracy=99.00: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████| 469/469 [01:00<00:00,  7.70it/s]

Training set: Average loss: 0.0405, Accuracy: 59399/60000 (99.00%)


Test set: Average loss: 0.0277, Accuracy: 9919/10000 (99.19%)

--------------------------------------------
--------------------------------------------
EPOCH: 13
Loss=0.06419075280427933 Batch_id=468 Accuracy=99.02: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 469/469 [01:00<00:00,  7.73it/s]

Training set: Average loss: 0.0642, Accuracy: 59412/60000 (99.02%)


Test set: Average loss: 0.0270, Accuracy: 9921/10000 (99.21%)

--------------------------------------------
--------------------------------------------
EPOCH: 14
Loss=0.037753667682409286 Batch_id=468 Accuracy=99.00: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████| 469/469 [01:40<00:00,  4.64it/s]

Training set: Average loss: 0.0378, Accuracy: 59401/60000 (99.00%)


Test set: Average loss: 0.0263, Accuracy: 9923/10000 (99.23%)

--------------------------------------------
--------------------------------------------
EPOCH: 15
Loss=0.03032008744776249 Batch_id=468 Accuracy=98.99: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 469/469 [01:35<00:00,  4.93it/s]

Training set: Average loss: 0.0303, Accuracy: 59393/60000 (98.99%)


Test set: Average loss: 0.0269, Accuracy: 9922/10000 (99.22%)

--------------------------------------------
--------------------------------------------
EPOCH: 16
Loss=0.0076263099908828735 Batch_id=468 Accuracy=98.96: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 469/469 [01:31<00:00,  5.15it/s]

Training set: Average loss: 0.0076, Accuracy: 59375/60000 (98.96%)


Test set: Average loss: 0.0269, Accuracy: 9919/10000 (99.19%)

--------------------------------------------
--------------------------------------------
EPOCH: 17
Loss=0.013512954115867615 Batch_id=468 Accuracy=98.99: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████| 469/469 [01:29<00:00,  5.25it/s]

Training set: Average loss: 0.0135, Accuracy: 59396/60000 (98.99%)


Test set: Average loss: 0.0271, Accuracy: 9917/10000 (99.17%)

--------------------------------------------
--------------------------------------------
EPOCH: 18
Loss=0.027513451874256134 Batch_id=468 Accuracy=99.00: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████| 469/469 [01:33<00:00,  5.04it/s]

Training set: Average loss: 0.0275, Accuracy: 59400/60000 (99.00%)


Test set: Average loss: 0.0267, Accuracy: 9921/10000 (99.21%)

--------------------------------------------
--------------------------------------------
EPOCH: 19
Loss=0.06087813898921013 Batch_id=468 Accuracy=98.99: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 469/469 [01:32<00:00,  5.05it/s]

Training set: Average loss: 0.0609, Accuracy: 59392/60000 (98.99%)


Test set: Average loss: 0.0281, Accuracy: 9922/10000 (99.22%)

--------------------------------------------
```